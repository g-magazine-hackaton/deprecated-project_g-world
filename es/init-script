#!/bin/bash

# Elasticsearch í˜¸ìŠ¤íŠ¸
ES_HOST="localhost:9200"

# Elasticsearchê°€ ì‹œì‘ë  ë•Œê¹Œì§€ ëŒ€ê¸°
until curl -s $ES_HOST -o /dev/null; do
    echo "Waiting for Elasticsearch...ğŸ¥²"
    sleep 5
done

echo "Elasticsearch started!!ğŸ˜"

# ì¸ë±ìŠ¤ ìƒì„±
curl -X PUT "$ES_HOST/test" -H 'Content-Type: application/json' -d'
{
  "mappings": {
    "properties": {
      "name": {
        "type": "text"
      },
      "company": {
        "type": "text"
      },
      "team": {
        "type": "text"
      }
    }
  }
}'

# ë°ì´í„° Bulk ì‚½ì…
curl -X POST "$ES_HOST/_bulk" -H 'Content-Type: application/json' -d'
{ "index" : { "_index" : "test", "_id" : "1" } }
{ "name" : "ë°•ìš°ë¦¼", "company" : "ì§€ë§ˆì¼“", "team" : "ë¡œì¼“ì£„ì†¡" }
{ "index" : { "_index" : "test", "_id" : "2" } }
{ "name" : "ì‹ ì˜ˆì€", "company" : "ì§€ë§ˆì¼“", "team" : "ë¡œì¼“ì£„ì†¡" }
{ "index" : { "_index" : "test", "_id" : "3" } }
{ "name" : "Hong Gil-dong", "company" : "Example Inc", "team" : "Development" }
'

# ë°ì´í„° ì—…ë°ì´íŠ¸
curl -X POST "$ES_HOST/test/_update/1" -H 'Content-Type: application/json' -d'
{
  "doc": {
    "team": "ë¡œì¼“ì§€ì†¡"
  }
}'

# ë°ì´í„° ì¡°íšŒ
curl -X GET "$ES_HOST/test/_search"

# ì¸ë±ìŠ¤ ì‚­ì œ
# curl -X DELETE "$ES_HOST/test"
